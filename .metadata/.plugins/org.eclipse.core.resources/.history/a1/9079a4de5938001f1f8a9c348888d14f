package org.bpelunit.framework.datasource;

import org.odftoolkit.odfdom.doc.OdfDocument;
import org.odftoolkit.odfdom.doc.OdfSpreadsheetDocument;
import org.odftoolkit.odfdom.doc.table.OdfTable;

public class OdsDataSource implements DataSource {

	@Override
	public void close() {
		// TODO Auto-generated method stub

	}

	@Override
	public String[] getFieldNames() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String[] getSupportedContentTypes() {
		return new String[] { "application/vnd.oasis.opendocument.spreadsheet",
				"application/x-vnd.oasis.opendocument.spreadsheet" };
	}

	@Override
	public String getValueFor(String fieldName) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public boolean next() {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public void setData(String data) throws InvalidDataSourceException {
		throw new InvalidDataSourceException(
				"Inline sources are not allowed for Open Document Spreadsheets (e.g. OpenOffice.org) files");
	}

	@Override
	public void setSource(String uri) throws InvalidDataSourceException {
		OdfDocument ods;
		try {
			ods = OdfSpreadsheetDocument.loadDocument(uri);
			OdfTable table = ods.getTableList().get(0);

		} catch (Exception e) {
			throw new InvalidDataSourceException("Could not open " + uri, e);
		}
	}

}
